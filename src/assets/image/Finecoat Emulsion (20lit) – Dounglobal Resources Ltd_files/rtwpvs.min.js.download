function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t){"use strict";window.rtWpvsVariationsFromInitialize=function(){t(".variations_form").each((function(){t(this).wc_variation_form()}))},t.fn.rtWpvsVariationSwatchesForm=function(){return this._variation_form=t(this),this.product_variations=this._variation_form.data("product_variations"),this._attributeTerms=this._variation_form.find(".variations select"),this._is_ajax=!!this.product_variations,this._is_archive=this._variation_form.hasClass("rtwpvs-product-loop-variation")||this._variation_form.hasClass("rtwpvs-archive-variation-wrapper"),this._out_of_stock={},this._is_mobile=t("body").hasClass("rtwpvs-is-mobile"),this.start=function(){var a=this;this._variation_form.find(".rtwpvs-terms-wrapper").each((function(){var r=t(this),i=r.parent().find("select.rtwpvs-wc-select");r.on("touchstart click",".rtwpvs-term:not(.rtwpvs-radio-term)",(function(r){r.preventDefault(),r.stopPropagation();var e=t(this),o=e.hasClass("selected"),s=e.data("term");o&&rtwpvs_params.reselect_clear&&(s=""),i.val(s).trigger("change").trigger("click").trigger("focusin"),a._is_mobile&&i.trigger("touchstart"),e.trigger("focus"),o?e.trigger("rtwpvs-unselected-term",[s,i,this._variation_form]):e.trigger("rtwpvs-selected-term",[s,i,this._variation_form])})),r.on("change","input.rtwpvs-radio-button-term:radio",(function(r){r.preventDefault(),r.stopPropagation();var e=t(this),o=e.val(),s=e.parent(".rtwpvs-term.rtwpvs-radio-term"),n=s.hasClass("selected");n&&rtwpvs_params.reselect_clear&&(o=""),i.val(o).trigger("change").trigger("click").trigger("focusin"),a._is_mobile&&i.trigger("touchstart"),rtwpvs_params.reselect_clear?n?_.delay((function(){e.prop("checked",!1),s.trigger("rtwpvs-unselected-term",[o,i,this._variation_form])}),1):s.trigger("rtwpvs-selected-term",[o,i,this._variation_form]):rtwpvs_params.reselect_clear||e.parent(".rtwpvs-term.rtwpvs-radio-term").removeClass("selected disabled").addClass("selected").trigger("rtwpvs-selected-term",[o,i,this._variation_form])})),rtwpvs_params.reselect_clear&&r.on("touchstart click","input.rtwpvs-radio-button-term:radio",(function(a){a.preventDefault(),a.stopPropagation(),t(this).trigger("change")}))})),setTimeout((function(){a._variation_form.trigger("reload_product_variations"),a._variation_form.trigger("rtwpvs_loaded",[a])}),1),this.initVariationURL()},this.update_trigger=function(){this._variation_form.on("rtwpvs_loaded",{that:this},this.loaded_triggered),this._variation_form.on("woocommerce_update_variation_values",this.update_variation_triggered),this._variation_form.on("reset_data",{that:this},this.reset_triggered),this._variation_form.on("woocommerce_variation_has_changed",{that:this},this.variation_has_changed_triggered)},this.update_variation_triggered=function(a){t(this).find(".rtwpvs-terms-wrapper").each((function(){var a=t(this),r=a.parent().find("select.rtwpvs-wc-select"),i=r.find("option:selected").val()||"",e=r.find("option:selected"),o=r.find("option").eq(1),s=[];r.find("option").each((function(){""!==t(this).val()&&(s.push(t(this).val()),i=e?e.val():o.val())})),setTimeout((function(){a.find(".rtwpvs-term").each((function(){var a=t(this),r=a.attr("data-term");a.removeClass("selected disabled").addClass("disabled"),-1!==s.indexOf(r)?(a.removeClass("disabled").find("input.rtwpvs-radio-button-term:radio").prop("disabled",!1),r===i&&a.addClass("selected").find("input.rtwpvs-radio-button-term:radio").prop("checked",!0)):a.find("input.rtwpvs-radio-button-term:radio").prop("disabled",!0).prop("checked",!1),r===i&&a.addClass("selected").find("input.rtwpvs-radio-button-term:radio").prop("disabled",!1).prop("checked",!0)})),a.trigger("rtwpvs-terms-updated")}),1)}))},this.variation_has_changed_triggered=function(a){a.data.that._is_ajax||t(this).find(".rtwpvs-terms-wrapper").each((function(){var a=t(this),r=a.parent().find("select.rtwpvs-wc-select"),i=r.find("option:selected").val()||"",e=r.find("option:selected"),o=r.find("option").eq(1),s=[];r.find("option").each((function(){""!==t(this).val()&&(s.push(t(this).val()),i=e?e.val():o.val())})),setTimeout((function(){a.find(".rtwpvs-term").each((function(){var a=t(this),r=a.attr("data-term");a.removeClass("selected disabled"),r===i&&a.addClass("selected").find("input.rtwpvs-radio-button-term:radio").prop("disabled",!1).prop("checked",!0)})),a.trigger("rtwpvs-terms-updated")}),1)}))},this.reset_triggered=function(a){a.data.that._is_ajax&&t(this).find(".rtwpvs-terms-wrapper").each((function(){t(this).find(".rtwpvs-term").removeClass("selected disabled").find("input.rtwpvs-radio-button-term:radio").prop("disabled",!1).prop("checked",!1)}))},this.loaded_triggered=function(a){var r=a.data.that;if(r._is_ajax){var i={};("object"===_typeof(r.product_variations)?r.product_variations:JSON.parse(r.product_variations)).map((function(t){t.attributes?Object.keys(t.attributes).map((function(a){i[a]||(i[a]=[]),t.attributes[a]&&-1===i[a].indexOf(t.attributes[a])&&i[a].push(t.attributes[a])})):console.log("variation.attributes Type ",_typeof(t.attributes))})),t(a.target).find(".rtwpvs-terms-wrapper").each((function(){var a=t(this).data("attribute_name");t(this).find(".rtwpvs-term").each((function(){var r=t(this),e=r.attr("data-term");t.isEmptyObject(i)||-1!==i[a].indexOf(e)||r.removeClass("selected").addClass("disabled").find("input.rtwpvs-radio-button-term:radio").prop("disabled",!0).prop("checked",!1)}))}))}},this.initVariationURL=function(){var a=this,r=window.location.toString(),i=a.closest(".rtwpvs-product");if(this._is_archive&&(r=i.find("a.woocommerce-LoopProduct-link").first().attr("href")),r){var e=new URL(r),o=e.searchParams.toString(),s=e.origin+e.pathname;this._variation_form.on("check_variations.wc-variation-form",(function(n){var _=void 0;rtwpvs_params.has_wc_bundles?(e=new URL(r),o=e.searchParams.toString(),_=a.getChosenAttributesBundleSupport()):_=a.getChosenAttributes();var c=Object.keys(_).reduce((function(t,a){return _[a]&&(t[a]=_[a]),t}),{}),d=a.urlParamsToObj(o),v=Object.assign({},d,c),p=t.param(v);!a._is_archive&&rtwpvs_params.enable_variation_url&&window.history.pushState({},"",a.setUrlParams(s,p)),a._is_archive&&rtwpvs_params.enable_archive_variation_url&&i.find("a:not(.rtwpvs_add_to_cart)").attr("href",a.setUrlParams(s,p))}))}},this.getChosenAttributesBundleSupport=function(){var a={};return this._attributeTerms.each((function(){var r=t(this).attr("name");a[r]=t(this).val()||""})),a},this.getChosenAttributes=function(){var a={};return this._attributeTerms.each((function(){var r=t(this).data("attribute_name")||t(this).attr("name");a[r]=t(this).val()||""})),a},this.urlParamsToObj=function(t){for(var a=Array.from(new URLSearchParams(t).keys()),r={},i=0;i<a.length;i++){var e=a[i];r[e]=new URLSearchParams(t).get(e)}return r},this.setUrlParams=function(t,a){if(a){a=(a=a.trim().replace(/^(\?|#|&)/,"").replace(/(\?|#|&)$/,""))?"?"+a:a;var r=t.split(/[\?\#]/)[0];a&&/\:\/\/[^\/]*$/.test(r)&&(r+="/");var i=t.match(/(\#.*)$/);t=r+a,i&&(t+=i[0])}return t},this.start(),this.update_trigger(),this},t.fn.wc_set_variation_attr=function(t,a){void 0===this.attr("data-o_"+t)&&this.attr("data-o_"+t,this.attr(t)?this.attr(t):""),!1===a?this.removeAttr(t):this.attr(t,a)},t.fn.wc_reset_variation_attr=function(t){void 0!==this.attr("data-o_"+t)&&this.attr(t,this.attr("data-o_"+t))},t.fn.rtWpvsVariationSwatchesArchiveForm=function(){this._variation_form=t(this),this._is_archive=this._variation_form.hasClass("rtwpvs-product-loop-variation")||this._variation_form.hasClass("rtwpvs-archive-variation-wrapper"),this.product_variations=this._variation_form.data("product_variations"),this._attributeTerms=this._variation_form.find(".variations select"),this._is_ajax=!!this.product_variations,this._wrapper=this._variation_form.closest(rtwpvs_params.archive_product_wrapper),this._is_mobile=t("body").hasClass("rtwpvs-is-mobile"),this._image=this._wrapper.find(rtwpvs_params.archive_image_selector),this._cart_button=this._wrapper.find(rtwpvs_params.archive_add_to_cart_button_selector),this._cart_button_ajax=this._wrapper.find(".rtwpvs_ajax_add_to_cart"),this._cart_button_html=this._cart_button.clone().html(),this._price=this._wrapper.find(rtwpvs_params.archive_product_price_selector),this._price_html=this._price.clone().html(),this._product_id=this._cart_button.data("product_id"),this.attributeData={},this.selectedData={},t.trim(rtwpvs_params.archive_add_to_cart_button_selector)&&(this._cart_button=this._wrapper.find(rtwpvs_params.archive_add_to_cart_button_selector),this._cart_button_ajax=this._wrapper.find(rtwpvs_params.archive_add_to_cart_button_selector)),this.resetArchiveVariation=function(){var t=this._wrapper.find(".price"),a=this._wrapper.find(".added_to_cart"),r=this._wrapper.find(".added_to_cart_button");t.html(this._price_html),this._cart_button.data("variation_id",""),this._cart_button.data("variation",""),rtwpvs_params.archive_swatches_enable_single_attribute||(rtwpvs_params.archive_add_to_cart_select_options?this._cart_button.html(rtwpvs_params.archive_add_to_cart_select_options):wc_add_to_cart_variation_params.i18n_select_options.trim()&&this._cart_button.text(wc_add_to_cart_variation_params.i18n_select_options),"no"===wc_add_to_cart_variation_params.enable_ajax_add_to_cart&&this._cart_button.prop("href",this._cart_button.data("product_permalink"))),this._cart_button.removeClass("added"),a.length>0&&a.remove(),r.length>0&&r.remove()},this.init_trigger=function(){if(this._is_archive){var a=this;this._variation_form.on("found_variation.rtwpvs-archive-variation",{variationForm:this._variation_form},(function(r,i){r.stopPropagation(),a.variationsImageUpdate(i);var e="",o=a._wrapper.find(".added_to_cart"),s=a._wrapper.find(".added_to_cart_button"),n=a._wrapper.find(".price");if(e=(e=(e=(i.variation_is_visible?wp.template("rtwpvs-variation-template"):wp.template("unavailable-variation-template"))({variation:i,price_html:t(i.price_html).unwrap().html()||a._price_html})).replace("/*<![CDATA[*/","")).replace("/*]]>*/",""),n.html(e),a._cart_button.data("variation_id",i.variation_id),a._cart_button.data("variation",a.getChosenAttributes()),!rtwpvs_params.archive_swatches_enable_single_attribute&&(rtwpvs_params.archive_add_to_cart_text?a._cart_button.html(rtwpvs_params.archive_add_to_cart_text):wc_add_to_cart_variation_params.i18n_add_to_cart.trim()&&a._cart_button.text(wc_add_to_cart_variation_params.i18n_add_to_cart),"no"===wc_add_to_cart_variation_params.enable_ajax_add_to_cart)){var _=t.param(Object.assign({},{"add-to-cart":a._product_id,variation_id:i.variation_id}));a._cart_button.prop("href",a.setUrlParams(a._cart_button.data("add_to_cart_url"),_))}a._cart_button.removeClass("added"),o.length>0&&o.remove(),s.length>0&&s.remove()})),this._variation_form.on("reset_image.rtwpvs-archive-variation",{variationForm:this._variation_form},(function(t){a.variationsImageUpdate(!1)})),this._variation_form.on("reset_data.rtwpvs-archive-variation",{variationForm:this._variation_form},(function(t){a.resetArchiveVariation()}))}this._cart_button_ajax.off("click.rtwpvs-archive-add-to-cart"),this._cart_button_ajax.on("click.rtwpvs-archive-add-to-cart",(function(a){var r=t(this);if(rtwpvs_params.archive_swatches_enable_single_attribute)return!0;if(!r.data("variation_id"))return!0;a.preventDefault(),a.stopPropagation(),r.removeClass("added").addClass("loading");var i={action:"rtwpvs_add_variation_to_cart"};t.each(r.data(),(function(t,a){i[t]=a})),t(document.body).trigger("adding_to_cart",[r,i]),t.post(wc_add_to_cart_variation_params.ajax_url.toString(),i,(function(a){a&&(a.error&&a.product_url?window.location=a.product_url:"yes"!==wc_add_to_cart_params.cart_redirect_after_add?t(document.body).trigger("added_to_cart",[a.fragments,a.cart_hash,r]):window.location=wc_add_to_cart_params.cart_url)}))}))},this.setUrlParams=function(t,a){if(a){a=(a=a.trim().replace(/^(\?|#|&)/,"").replace(/(\?|#|&)$/,""))?"?"+a:a;var r=t.split(/[\?\#]/)[0];a&&/\:\/\/[^\/]*$/.test(r)&&(r+="/");var i=t.match(/(\#.*)$/);t=r+a,i&&(t+=i[0])}return t},this.urlParamsToObj=function(t){for(var a=Array.from(new URLSearchParams(t).keys()),r={},i=0;i<a.length;i++){var e=a[i];r[e]=new URLSearchParams(t).get(e)}return r},this.init=function(){this.init_trigger();var a=this;_.delay((function(){a.setDefaultImages(),a._variation_form.trigger("rtwpvs_archive_init",[a,a.product_variations]),t(document).trigger("rtwpvs_archive_init_loaded",[a._variation_form,a.product_variations])}),2)},this.setDefaultImages=function(){var a=this;_.delay((function(){a._variation_form.find(".rtwpvs-terms-wrapper > .rtwpvs-term:not(.disabled)").each((function(r,i){t(this).off("rtwpvs-selected-item.archive-image-hover"),t(this).off("rtwpvs-selected-item.archive-image-click"),t(this).off("mouseenter.archive-image-hover"),t(this).off("mouseleave.archive-image-hover"),"hover"===rtwpvs_params.archive_swatches_display_event&&t(this).on("mouseenter.archive-image-hover",(function(r){r.stopPropagation(),t(this).trigger("click").trigger("focusin"),a._is_mobile&&t(this).trigger("touchstart")}))}))}),2)},this.variationsImageUpdate=function(a){var r=this._wrapper.find(rtwpvs_params.archive_image_selector);r.addClass("rtwpvs-image-load").one("webkitAnimationEnd oanimationend msAnimationEnd animationend webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(function(){t(this).removeClass("rtwpvs-image-load")})),a&&a.image&&a.image.thumb_src&&a.image.thumb_src.length>1?(r.wc_set_variation_attr("src",a.image.thumb_src),r.wc_set_variation_attr("height",a.image.thumb_src_h),r.wc_set_variation_attr("width",a.image.thumb_src_w),r.wc_set_variation_attr("srcset",a.image.thumb_srcset),r.wc_set_variation_attr("sizes",a.image.thumb_sizes),r.wc_set_variation_attr("title",a.image.title),r.wc_set_variation_attr("alt",a.image.alt)):(r.wc_reset_variation_attr("src"),r.wc_reset_variation_attr("width"),r.wc_reset_variation_attr("height"),r.wc_reset_variation_attr("srcset"),r.wc_reset_variation_attr("sizes"),r.wc_reset_variation_attr("title"),r.wc_reset_variation_attr("alt"))},this.isMatch=function(t,a){var r=!0;for(var i in t)if(t.hasOwnProperty(i)){var e=t[i],o=a[i];void 0!==e&&void 0!==o&&0!==e.length&&0!==o.length&&e!==o&&(r=!1)}return r},this.findMatchingVariations=function(t,a){for(var r=[],i=0;i<t.length;i++){var e=t[i];this.isMatch(e.attributes,a)&&r.push(e)}return r},this.getChosenAttributes=function(){var a={};return this._attributeTerms.each((function(){var r=t(this).data("attribute_name")||t(this).attr("name");a[r]=t(this).val()||""})),a},this.init(),t(document).trigger("rtwpvs_archive",[this._variation_form])},window.rtWpvsLoadArchiveVariations=function(){if(rtwpvs_params.enable_ajax_archive_variation)for(var a=document.querySelectorAll(".rtwpvs-archive-variation-wrapper:not(.rtwpvs_av_loaded):not(.rtwpvs_av_loading)"),r=0;r<a.length;r++){new IntersectionObserver(i,{root:null,rootMargin:"0px",threshold:0}).observe(a[r])}function i(a,r){a.forEach((function(a){if(a.isIntersecting){var i=a.target,e=t(i);if(!i.classList.contains("rtwpvs_av_loading")||!i.classList.contains("rtwpvs_av_loaded")){var o=parseInt(i.getAttribute("data-product_id"),10),s=JSON.parse(i.getAttribute("data-product_variations"));rtwpvs_params.enable_ajax_archive_variation&&!1===s&&o&&t.ajax({type:"POST",url:rtwpvs_params.ajax_url,data:{action:"rtwpvs_load_product_variation",rtwpvs_nonce:rtwpvs_params.nonce,product_id:o},beforeSend:function(){i.classList.add("rtwpvs_av_loading")},success:function(a){a.success&&(i.classList.add("rtwpvs_av_loaded"),t(i).data("product_variations",a.data),setTimeout((function(){e.on("wc_variation_form",(function(){t(this).rtWpvsVariationSwatchesForm(),t(this).rtWpvsVariationSwatchesArchiveForm()})).wc_variation_form()}),100))},error:function(){console.error("Error Loading Data...")},complete:function(){e.removeClass("rtwpvs_av_loading")}})}r.unobserve(i)}}))}},window.rtWpvsWithoutAjaxVariations=function(){if(!rtwpvs_params.enable_ajax_archive_variation){var a=t(".variations_form").hasClass("rtwpvs-product-loop-variation")?".variations_form.rtwpvs-product-loop-variation":".variations_form.rtwpvs-archive-variation-wrapper";t(document).on("wc_variation_form",a,(function(){t(this).rtWpvsVariationSwatchesForm(),t(this).rtWpvsVariationSwatchesArchiveForm()})),t(document).on("yith_infs_added_elem yith-wcan-ajax-filtered post-load quick-view-displayed wood-images-loaded astraInfinitePaginationLoaded berocket_ajax_products_loaded facetwp-loaded",(function(){rtWpvsVariationsFromInitialize()})),t(".shop-container .products").on("append.infiniteScroll",(function(t,a,r){rtWpvsVariationsFromInitialize()})),t("body").on("aln_reloaded",(function(){_.delay((function(){rtWpvsVariationsFromInitialize()}),100)})),t(document.body).on("konte_products_loaded",(function(){rtWpvsVariationsFromInitialize()}))}},window.rtWpvsWithAjaxVariations=function(){rtwpvs_params.enable_ajax_archive_variation&&(t(document).on("yith_infs_added_elem yith-wcan-ajax-filtered post-load quick-view-displayed wood-images-loaded astraInfinitePaginationLoaded berocket_ajax_products_loaded facetwp-loaded",(function(){rtWpvsLoadArchiveVariations()})),t(".shop-container .products").on("append.infiniteScroll",(function(t,a,r){rtWpvsLoadArchiveVariations()})),t("body").on("aln_reloaded",(function(){_.delay((function(){rtWpvsLoadArchiveVariations()}),100)})),t(document.body).on("konte_products_loaded",(function(){rtWpvsLoadArchiveVariations()})))},rtWpvsWithoutAjaxVariations(),rtWpvsWithAjaxVariations(),t(document).ready((function(){rtWpvsLoadArchiveVariations()})),t(document).on("wc_variation_form",".variations_form.cart",(function(){t(this).rtWpvsVariationSwatchesForm()})),t("body").on("click",".rtwpvs-details-term-more",(function(){var a=t(this);a.parents(".rtwpvs-terms-wrapper").removeClass("has-more-variation"),a.remove()}))}(jQuery);
